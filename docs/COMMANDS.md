# æŒ‡ä»¤å‚è€ƒ

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜ crater-ohos-bot æ”¯æŒçš„æ‰€æœ‰æŒ‡ä»¤ã€‚

## åŸºæœ¬ç”¨æ³•

æ‰€æœ‰æŒ‡ä»¤éƒ½ä»¥è§¦å‘å‰ç¼€å¼€å¤´ï¼ˆé»˜è®¤ä¸º `@crater-bot`ï¼‰ï¼Œåœ¨ GitCode Issue çš„è¯„è®ºä¸­ä½¿ç”¨ã€‚

**æ ¼å¼**:
```
@crater-bot <command> [arguments...]
```

## æŒ‡ä»¤åˆ—è¡¨

### 1. run - è¿è¡Œå®éªŒ

åˆ›å»ºå¹¶è¿è¡Œä¸€ä¸ªæ–°çš„ crater å®éªŒã€‚

**è¯­æ³•**:
```
@crater-bot run <toolchain1> <toolchain2> [toolchain3...]
```

**å‚æ•°**:
- `toolchain1`, `toolchain2`, ... - è¦æ¯”è¾ƒçš„å·¥å…·é“¾åç§°ï¼ˆè‡³å°‘éœ€è¦ 2 ä¸ªï¼‰

**å·¥å…·é“¾æ ¼å¼**:
- `stable` - æœ€æ–°ç¨³å®šç‰ˆ
- `beta` - æœ€æ–°æµ‹è¯•ç‰ˆ
- `nightly` - æœ€æ–°æ¯å¤œç‰ˆ
- `nightly-YYYY-MM-DD` - ç‰¹å®šæ—¥æœŸçš„æ¯å¤œç‰ˆ
- `1.70.0` - ç‰¹å®šç‰ˆæœ¬å·

**ç¤ºä¾‹**:

æ¯”è¾ƒ stable å’Œ beta:
```
@crater-bot run stable beta
```

æ¯”è¾ƒç‰¹å®š nightly ç‰ˆæœ¬å’Œ stable:
```
@crater-bot run nightly-2024-01-01 stable
```

æ¯”è¾ƒä¸‰ä¸ªå·¥å…·é“¾:
```
@crater-bot run stable beta nightly
```

æ¯”è¾ƒä¸¤ä¸ªç‰¹å®šç‰ˆæœ¬:
```
@crater-bot run 1.70.0 1.71.0
```

**å“åº”**:

æˆåŠŸæ—¶ï¼ŒBot ä¼šå›å¤:
```
âœ… å®éªŒ `gitcode-user-repo-123` å·²åˆ›å»ºå¹¶å¼€å§‹æ‰§è¡Œã€‚

å·¥å…·é“¾ï¼šstable vs beta
æ¨¡å¼ï¼šbuild-and-test
çŠ¶æ€ï¼šæ’é˜Ÿä¸­

æˆ‘ä¼šåœ¨å®éªŒå®Œæˆåé€šçŸ¥æ‚¨ã€‚
```

å¤±è´¥æ—¶ä¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚

**æ³¨æ„äº‹é¡¹**:
- æ¯ä¸ª Issue åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªæ´»è·ƒçš„å®éªŒ
- å®éªŒåç§°ä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œæ ¼å¼ä¸º `{project}-{issue_id}`
- å®éªŒå®Œæˆåä¼šè‡ªåŠ¨åœ¨ Issue ä¸­å‘å¸ƒç»“æœ

---

### 2. status - æŸ¥è¯¢çŠ¶æ€

æŸ¥è¯¢å½“å‰ Issue å…³è”çš„å®éªŒçŠ¶æ€ã€‚

**è¯­æ³•**:
```
@crater-bot status
```

**å‚æ•°**: æ— 

**ç¤ºä¾‹**:
```
@crater-bot status
```

**å“åº”**:

å¦‚æœæœ‰å…³è”çš„å®éªŒ:
```
ğŸ“Š å®éªŒçŠ¶æ€

åç§°ï¼š`gitcode-user-repo-123`
å·¥å…·é“¾ï¼šstable vs beta
çŠ¶æ€ï¼šè¿è¡Œä¸­
æ¨¡å¼ï¼šbuild-and-test
```

å¦‚æœæ²¡æœ‰å…³è”çš„å®éªŒ:
```
å½“å‰æ²¡æœ‰ä¸æ­¤ Issue å…³è”çš„å®éªŒã€‚
```

**å¯èƒ½çš„çŠ¶æ€**:
- æ’é˜Ÿä¸­ (Queued) - ç­‰å¾…æ‰§è¡Œ
- è¿è¡Œä¸­ (Running) - æ­£åœ¨æ‰§è¡Œ
- å·²å®Œæˆ (Completed) - æˆåŠŸå®Œæˆ
- å¤±è´¥ (Failed) - æ‰§è¡Œå¤±è´¥
- å·²ä¸­æ­¢ (Aborted) - å·²è¢«ä¸­æ­¢

---

### 3. abort - ä¸­æ­¢å®éªŒ

ä¸­æ­¢å½“å‰ Issue å…³è”çš„æ­£åœ¨è¿è¡Œçš„å®éªŒã€‚

**è¯­æ³•**:
```
@crater-bot abort
```

**å‚æ•°**: æ— 

**ç¤ºä¾‹**:
```
@crater-bot abort
```

**å“åº”**:

æˆåŠŸæ—¶:
```
â¹ï¸ å®éªŒ `gitcode-user-repo-123` å·²ä¸­æ­¢ã€‚
```

å¦‚æœæ²¡æœ‰å¯ä¸­æ­¢çš„å®éªŒ:
```
å½“å‰æ²¡æœ‰ä¸æ­¤ Issue å…³è”çš„å®éªŒå¯ä»¥ä¸­æ­¢ã€‚
```

**æ³¨æ„äº‹é¡¹**:
- åªèƒ½ä¸­æ­¢æ­£åœ¨è¿è¡Œæˆ–æ’é˜Ÿä¸­çš„å®éªŒ
- å·²å®Œæˆæˆ–å·²å¤±è´¥çš„å®éªŒæ— æ³•ä¸­æ­¢
- ä¸­æ­¢åæ— æ³•æ¢å¤ï¼Œéœ€è¦é‡æ–°è¿è¡Œ

---

### 4. list - åˆ—å‡ºå®éªŒ

åˆ—å‡ºæ‰€æœ‰å®éªŒï¼ˆä¸é™äºå½“å‰ Issueï¼‰ã€‚

**è¯­æ³•**:
```
@crater-bot list
```

**å‚æ•°**: æ— 

**ç¤ºä¾‹**:
```
@crater-bot list
```

**å“åº”**:

å¦‚æœæœ‰å®éªŒ:
```
## å®éªŒåˆ—è¡¨

- `gitcode-user-repo-123` - è¿è¡Œä¸­ (stable vs beta)
- `gitcode-user-repo-124` - å·²å®Œæˆ (nightly vs stable)
- `gitcode-another-repo-45` - æ’é˜Ÿä¸­ (beta vs nightly)

_...è¿˜æœ‰ 5 ä¸ªå®éªŒ_
```

å¦‚æœæ²¡æœ‰å®éªŒ:
```
å½“å‰æ²¡æœ‰å®éªŒã€‚
```

**æ³¨æ„äº‹é¡¹**:
- æœ€å¤šæ˜¾ç¤ºå‰ 10 ä¸ªå®éªŒ
- å¦‚æœè¶…è¿‡ 10 ä¸ªï¼Œä¼šæ˜¾ç¤ºå‰©ä½™æ•°é‡
- æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·çš„å®éªŒï¼Œä¸é™äºå½“å‰ä»“åº“

---

### 5. help - æ˜¾ç¤ºå¸®åŠ©

æ˜¾ç¤º Bot çš„å¸®åŠ©ä¿¡æ¯å’Œå¯ç”¨å‘½ä»¤åˆ—è¡¨ã€‚

**è¯­æ³•**:
```
@crater-bot help
```

æˆ–è€…åªè¾“å…¥è§¦å‘å‰ç¼€:
```
@crater-bot
```

**å‚æ•°**: æ— 

**ç¤ºä¾‹**:
```
@crater-bot help
```

**å“åº”**:
```
## crater-bot å¸®åŠ©

### å¯ç”¨å‘½ä»¤

- `@crater-bot run <toolchain1> <toolchain2>` - åˆ›å»ºå¹¶è¿è¡Œå®éªŒ
- `@crater-bot status` - æŸ¥çœ‹å½“å‰å®éªŒçŠ¶æ€
- `@crater-bot abort` - ä¸­æ­¢å½“å‰å®éªŒ
- `@crater-bot list` - åˆ—å‡ºæ‰€æœ‰å®éªŒ
- `@crater-bot help` - æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯

### ç¤ºä¾‹

```
@crater-bot run stable beta
@crater-bot run nightly-2024-01-01 stable
```
```

---

## é”™è¯¯å¤„ç†

å½“å‘½ä»¤æ‰§è¡Œå‡ºé”™æ—¶ï¼ŒBot ä¼šå›å¤é”™è¯¯ä¿¡æ¯ï¼š

**æ ¼å¼**:
```
âŒ é”™è¯¯: <error message>
```

**å¸¸è§é”™è¯¯**:

1. **å‚æ•°ä¸è¶³**:
```
âŒ é”™è¯¯: run å‘½ä»¤éœ€è¦è‡³å°‘ä¸¤ä¸ªå·¥å…·é“¾å‚æ•°ã€‚ç”¨æ³•: @crater-bot run <toolchain1> <toolchain2>
```

2. **æœªçŸ¥å‘½ä»¤**:
```
âŒ é”™è¯¯: æœªçŸ¥å‘½ä»¤: xyz. ä½¿ç”¨ 'help' æŸ¥çœ‹å¯ç”¨å‘½ä»¤
```

3. **API é”™è¯¯**:
```
âŒ é”™è¯¯: Crater API error: Failed to create experiment: 500 - Internal Server Error
```

---

## é«˜çº§ç”¨æ³•

### åœ¨åŒä¸€è¯„è®ºä¸­ä½¿ç”¨å¤šä¸ªå‘½ä»¤

ä¸æ”¯æŒã€‚æ¯æ¡è¯„è®ºåªèƒ½åŒ…å«ä¸€ä¸ª Bot å‘½ä»¤ã€‚

### å‘½ä»¤å¤§å°å†™

å‘½ä»¤åç§°ä¸åŒºåˆ†å¤§å°å†™:
```
@crater-bot STATUS  # å¯ä»¥
@crater-bot status  # å¯ä»¥
@crater-bot Status  # å¯ä»¥
```

### è§¦å‘å‰ç¼€è‡ªå®šä¹‰

å¦‚æœç®¡ç†å‘˜ä¿®æ”¹äº†é…ç½®æ–‡ä»¶ä¸­çš„ `trigger_prefix`ï¼Œéœ€è¦ä½¿ç”¨æ–°çš„å‰ç¼€:

```toml
[bot]
trigger_prefix = "@my-bot"
```

ä½¿ç”¨:
```
@my-bot run stable beta
```

---

## å®éªŒå·¥ä½œæµç¤ºä¾‹

### åœºæ™¯ 1: æ ‡å‡†å·¥ä½œæµ

1. **åˆ›å»º Issue** æè¿°è¦æµ‹è¯•çš„å†…å®¹
2. **å‘èµ·å®éªŒ**:
   ```
   @crater-bot run stable beta
   ```
3. **ç­‰å¾…ç¡®è®¤** (Bot å›å¤å®éªŒå·²åˆ›å»º)
4. **æŸ¥è¯¢çŠ¶æ€**ï¼ˆå¯é€‰ï¼‰:
   ```
   @crater-bot status
   ```
5. **ç­‰å¾…å®Œæˆ** (Bot ä¼šè‡ªåŠ¨å‘å¸ƒç»“æœ)
6. **æŸ¥çœ‹æŠ¥å‘Š** (ç‚¹å‡» Bot æä¾›çš„é“¾æ¥)

### åœºæ™¯ 2: ä¸­æ­¢å¹¶é‡æ–°è¿è¡Œ

1. **å‘èµ·å®éªŒ**:
   ```
   @crater-bot run nightly stable
   ```
2. **å‘ç°é…ç½®é”™è¯¯ï¼Œä¸­æ­¢**:
   ```
   @crater-bot abort
   ```
3. **é‡æ–°è¿è¡Œ**:
   ```
   @crater-bot run nightly-2024-01-15 stable
   ```

### åœºæ™¯ 3: æŸ¥çœ‹æ‰€æœ‰å®éªŒ

1. **åˆ—å‡ºå®éªŒ**:
   ```
   @crater-bot list
   ```
2. **æŸ¥çœ‹ç‰¹å®šå®éªŒçŠ¶æ€**:
   ```
   @crater-bot status
   ```

---

## å®éªŒç»“æœé€šçŸ¥

å®éªŒå®Œæˆåï¼ŒBot ä¼šè‡ªåŠ¨åœ¨ Issue ä¸­å‘å¸ƒç»“æœï¼š

**æˆåŠŸå®Œæˆ**:
```
ğŸ‰ å®éªŒ `gitcode-user-repo-123` å·²å®Œæˆï¼

ğŸ“Š æŸ¥çœ‹å®Œæ•´æŠ¥å‘Šï¼š[ç‚¹å‡»æŸ¥çœ‹](https://crater.example.com/reports/...)
```

**å¤±è´¥**:
```
âŒ å®éªŒ `gitcode-user-repo-123` å¤±è´¥ã€‚
```

**ä¸­æ­¢**:
```
â¹ï¸ å®éªŒ `gitcode-user-repo-123` å·²ä¸­æ­¢ã€‚
```

---

## é…ç½®å‚æ•°

ä»¥ä¸‹å‚æ•°å¯ä»¥åœ¨ `config.toml` ä¸­é…ç½®ï¼Œå½±å“å‘½ä»¤è¡Œä¸ºï¼š

```toml
[bot]
name = "crater-bot"                # Bot åç§°
trigger_prefix = "@crater-bot"     # è§¦å‘å‰ç¼€
default_mode = "build-and-test"    # é»˜è®¤å®éªŒæ¨¡å¼
default_crate_select = "demo"      # é»˜è®¤åŒ…é€‰æ‹©
```

**å®éªŒæ¨¡å¼**:
- `build-and-test` - æ„å»ºå¹¶æµ‹è¯•ï¼ˆé»˜è®¤ï¼‰
- `build-only` - ä»…æ„å»º
- `check-only` - ä»…æ£€æŸ¥

**åŒ…é€‰æ‹©**:
- `demo` - æ¼”ç¤ºåŒ…ï¼ˆé»˜è®¤ï¼‰
- `full` - å®Œæ•´ç”Ÿæ€
- `top-100` - å‰ 100 ä¸ªåŒ…

---

## æœ€ä½³å®è·µ

1. **æè¿°æ¸…æ™°**: åœ¨ Issue ä¸­æè¿°æ¸…æ¥šè¦æµ‹è¯•çš„å†…å®¹
2. **åŠæ—¶æŸ¥çœ‹**: å®éªŒå®ŒæˆååŠæ—¶æŸ¥çœ‹æŠ¥å‘Š
3. **åˆç†ä½¿ç”¨**: ä¸è¦é¢‘ç¹åˆ›å»ºå¤§é‡å®éªŒ
4. **æ¸…ç†èµ„æº**: å®Œæˆåå¯ä»¥å…³é—­ Issue

---

## ç–‘éš¾è§£ç­”

**é—®ï¼šBot æ²¡æœ‰å“åº”æˆ‘çš„å‘½ä»¤**

ç­”ï¼šæ£€æŸ¥ï¼š
- è§¦å‘å‰ç¼€æ˜¯å¦æ­£ç¡®
- å‘½ä»¤æ‹¼å†™æ˜¯å¦æ­£ç¡®
- Bot æ˜¯å¦æ­£å¸¸è¿è¡Œï¼ˆè”ç³»ç®¡ç†å‘˜ï¼‰

**é—®ï¼šå®éªŒä¸€ç›´æ˜¾ç¤º"æ’é˜Ÿä¸­"**

ç­”ï¼šå¯èƒ½æ˜¯ crater æœåŠ¡ç¹å¿™æˆ–æœ‰å…¶ä»–å®éªŒåœ¨è¿è¡Œï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚

**é—®ï¼šå¦‚ä½•å–æ¶ˆä¸€ä¸ªå®éªŒï¼Ÿ**

ç­”ï¼šä½¿ç”¨ `@crater-bot abort` å‘½ä»¤ã€‚

**é—®ï¼šå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªå®éªŒå—ï¼Ÿ**

ç­”ï¼šå¯ä»¥ï¼Œä½†æ¯ä¸ª Issue åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªå…³è”çš„å®éªŒã€‚

---

## åé¦ˆå’Œæ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜æˆ–æœ‰å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
2. åœ¨é¡¹ç›®ä»“åº“åˆ›å»º Issue
3. è”ç³»ç»´æŠ¤è€…
